<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru">
<head>
    <link rel="stylesheet" href="/www/css/smoothness/jquery-ui-1.8.14.custom.css">
    <link rel="stylesheet" href="/www/css/ui.jqgrid.css">
    <link rel="stylesheet" href="/www/css/enodeman.css">
    <script type="text/javascript" src="/www/js/jquery.js"></script>
    <script type="text/javascript" src="/www/js/jquery-ui-1.8.14.custom.min.js"></script>
    <script type="text/javascript" src="/www/js/grid.locale-en.js"></script>
    <script type="text/javascript" src="/www/js/jquery.jqGrid.min.js"></script>
    <script type="text/javascript" src="/www/js/enodeman_grid.js"></script>
    <script type="text/javascript" src="/www/js/jit.js"></script>
    <script type="text/javascript" src="/www/js/enodeman_tree.js"></script>
    <script type="text/javascript" src="/www/js/raphaeljs/raphael-min.js"></script>
    <script type="text/javascript" src="/www/js/raphaeljs/g.raphael-min.js"></script>
    <script type="text/javascript" src="/www/js/raphaeljs/g.line-min.js"></script>
    <script type="text/javascript" src="/www/js/enodeman_graph.js"></script>
    <script type="text/javascript" src="/www/js/enodeman_stats.js"></script>
</head>
<body>
    <table id="nodes-list"></table>
    <!--div id="nodes-pager"></div-->
    <br>
    <div id="enm-tabs">
        <ul>
            <li><a href="#tabs-1">Processes</a></li>
            <li><a href="#tabs-2">Tree</a></li>
            <li><a href="#tabs-3">Graphs</a></li>
        </ul>
        <div id="tabs-1">
            <table id="processes-list"></table>
            <!--div id="processes-pager"></div-->
        </div>
        <div id="tabs-2">
            <div id="enm-tree"></div>
        </div>
        <div id="tabs-3">
            <div id="enm-graphs"></div>
        </div>
    </div>
    <script type="text/javascript">
        (function() {
            var tree = new ENMTree({
                targetId: "enm-tree",
                dataURL: "/nodes/processes_tree",
                duration: 800,
                levelDistance: 50,
                node: {
                    height: 20,
                    width: 60,
                    type: "rectangle",
                    color: "#aaa"
                },
                edge: {
                    type: "bezier"
                }
            });
            $("#enm-tabs").tabs({
                show: function(e, ui) {
                    if (ui.panel.id == "tabs-2") {
                        tree.show(tree.data);
                    }
                }
            });
            var nodeClickHandler = function(rowId) {
                $("#processes-list").GridUnload();
                new ENMGrid({
                    target: $("#processes-list"),
                    //pager: $("#processes-pager"),
                    caption: "Processes",
                    columnsSpecUrl: "/proc_metrics",
                    dataUrl: "/" + rowId + "/processes"
                });
                ENMStats(rowId);
            };
            new ENMGrid({
                target: $("#nodes-list"),
                //pager: $("#nodes-pager"),
                caption: "Nodes",
                columnsSpecUrl: "/node_metrics",
                dataUrl: "/nodes",
                nodeClickHandler: nodeClickHandler
            });
        })();
    </script>
</body>
</html>
